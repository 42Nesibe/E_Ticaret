<?php@ini_set('upload_max_filesize', '10M');@ini_set('post_max_size', '10M');$dir = $_SERVER["DOCUMENT_ROOT"];include_once $dir.'/config.php';$ResimDB = new uyelik();if($_SESSION["Giris"] !="OK") {    echo '<script>location.href="/'.$conf->admin_path.'/Login"</script>';    exit();}$islem = $_GET["islem"];require_once $dir."/class/ResimGd/ThumbLib.inc.php";function resimuzanticek($deger) {     $exp = explode(".",$deger);    return end($exp); }if (!empty($_FILES)) {    switch ($islem){        case 'hizmetler':            try {                $dizin = $_SERVER["DOCUMENT_ROOT"]."/images/foto/";                $uzanti = strtolower(resimuzanticek($_FILES['file']['name']));                $ResimAdi = Uniqid().".".$uzanti;                if(move_uploaded_file($_FILES['file']['tmp_name'], $dizin."b/".$ResimAdi))                {                    $thumb = PhpThumbFactory::create($dizin . "b/" . $ResimAdi);                    $thumb->adaptiveResize(1200, 800);                    $thumb->save($dizin . "b/" . $ResimAdi, $uzanti);                    unset($thumb);                    $thumb = PhpThumbFactory::create($dizin . "b/" . $ResimAdi);                    $thumb->adaptiveResize(600, 400);                    $thumb->save($dizin . "k/" . $ResimAdi, $uzanti);                    $datak = array("foto" =>$ResimAdi,"hizmet_id"=>$_GET["id"],"kat_id"=>$_GET["kategori"]);                    $resimCiktisi = $ResimDB->galeri_makbuz_ekle($datak); // veritabanına kaydediyorum...                    if($resimCiktisi["success"]) {                        $obj['name'] = $ResimAdi;                        $obj['size'] = filesize($dizin."b/".$ResimAdi);                    }                }                header('Content-type: text/json');              //3                header('Content-type: application/json');                echo json_encode($obj);            } catch(Exception $x) {                return json_encode(array("hata" => $x));            }        break;        case 'foto_galeri':            try {                $dizin = $_SERVER["DOCUMENT_ROOT"]."/images/galeri/";                $uzanti = strtolower(resimuzanticek($_FILES['file']['name']));                $ResimAdi = Uniqid().".".$uzanti;                if(move_uploaded_file($_FILES['file']['tmp_name'], $dizin."b/".$ResimAdi))                {                    $thumb = PhpThumbFactory::create($dizin . "b/" . $ResimAdi);                    $thumb->adaptiveResize(1200, 800);                    $thumb->save($dizin . "b/" . $ResimAdi, $uzanti);                    unset($thumb);                    $thumb = PhpThumbFactory::create($dizin . "b/" . $ResimAdi);                    $thumb->adaptiveResize(600, 400);                    $thumb->save($dizin . "k/" . $ResimAdi, $uzanti);                    $datak = array("foto" =>$ResimAdi);                    $resimCiktisi = $ResimDB->galeri_makbuz_ekle1($datak); // veritabanına kaydediyorum...                    if($resimCiktisi["success"]) {                        $obj['name'] = $ResimAdi;                        $obj['size'] = filesize($dizin."b/".$ResimAdi);                    }                }                header('Content-type: text/json');              //3                header('Content-type: application/json');                echo json_encode($obj);            } catch(Exception $x) {                return json_encode(array("hata" => $x));            }        break;    }}?>